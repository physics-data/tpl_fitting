# 芃芃爱的四次方（Very Impressive Kurve Interpolation）

## 问题背景

又到了每年 n 度的 XX 情人节，芃芃想在礼物上画一个爱心，自己手画了几个，要么左大右小，要么左小右大，总是不够整齐。拿网上已有的曲线吧，又显得自己不够诚意，想到用机器来打印一个上去。去找淘宝商家问了一下定制的要求，客服告诉芃芃，给的图片必须得是矢量图，意味着放大也不会变模糊；由于机器限制，矢量图只能由多个四次曲线组合而成。芃芃心生一计：我先画一个爱心的草图，在上面选几个点，把这些点拟合成一个四次曲线，不就可以得到一个又对称又有诚意的爱心了吗！因为跳级太猛而忘记了线性代数的芃芃找到了你，希望你可以用最小二乘法帮他把解算出来。

## 问题描述

你需要编写一个 Python 程序完成 JSON 文件的读写，根据输入的各个点，采用最小二乘法算出四次曲线的参数，然后输出。具体来说，你需要修改项目中的 `interpolation.py`，并完成以下功能：

1. 读取 JSON 文件（路径为sys.argv[1]），得到在这条四次曲线上的几个点的坐标（输入中 "points" 的内容）
2. 按照最小二乘法（下面提供了描述），拟合出一个四次曲线
3. 把输入数据中指定的点（输入中 "predict" 的内容）的坐标代入拟合出来的四次曲线，然后把拟合出来的坐标输出到 JSON 文件（路径为 sys.argv[2]）

项目中的 `interpolation.py` 已经提供了必要的代码和提示，已经提供了部分输入和输出的代码以供参考。和之前的题目一样，可以通过执行 `python3 hd5.py [input_file] [output_file]` 来进行数据的处理，但注意不要把 `data` 目录下的文件覆盖。

如果忘记了最小二乘法的矩阵形式，这里是一段简单的描述：

对于每一段四次曲线，我们都给定了 $m_i$ 个点 $(x_1, y_1), \dots, (x_{m_i}, y_{m_i})$。如果设这条四次曲线的表达式为 $y=ax^4+bx^3+cx^2+dx+e$，那么我们就能得到以下的方程组：
$$
\begin{cases}
x_1^4a+x_1^3b+x_1^2c+x_1d+e=y_1 \\
\cdots \\
x_{m_i}^4a+x_{m_i}^3b+x_{m_i}^2c+x_{m_i}d+e=y_{m_i!}
\end{cases}
$$
如果设 $\mathbf{A}_{ij}=x_{i}^{5-j}$，$\mathbf{x}=[a\,b\,c\,d\,e]^\intercal$，$\mathbf{b}=[y_1\,\dots\,y_{m_i}]^\intercal$，上述方程组就等价于矩阵方程 $\mathbf{Ax=b}$。这通常不是一个可以直接求解的方程组，因此我们通常使用最小二乘法求解，即求解方程 $\mathbf{A^\intercal Ax=A^\intercal b}$。这总是一个具有唯一解的方程组，并且得到的解具有最小的均方差距离，我们在此不加以证明。而在得到最小二乘解 $\tilde{\mathbf{x}}=[\tilde{a}\,\tilde{b}\,\tilde{c}\,\tilde{d}\,\tilde{e}]^\intercal$ 后，对于任意给定的 $x$，我们就能计算出一个 $y$，这就是插值的过程。

如果阅读 LaTeX 格式的数学公式有困难，可以到 GitHub 上查看，也可以查看下面的图片：

![这是一个图片，请上GitHub看](interpolation.png)

## 样例与评分

我们在 `data` 目录下提供了四组数据，分别对应不同的曲线，这次正式评测不会使用额外的数据。和之前的题目一样，你可以通过 `python3 grade.py` 来进行一次的本地测评。

评测程序会读取你的程序的输出，与正确答案进行对比。并且按照你的输出绘制出一个图形，当你实现正确时，应该可以得到心型图案。

这次数据量很小，虽然仍然设置了 2s 的时间限制，但基本不会达到。

最终分数构成为：

* 黑盒 80 分：共 4 个测例，每个 20 分
* 白盒 20 分：代码风格与 Git 使用 20 分（包括恰当注释、合理命名、提交日志等）

助教以 deadline 前 GitHub 上最后一次提交为准进行评测。